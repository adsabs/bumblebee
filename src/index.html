<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <base href="/" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,user-scalable=no" />
    <meta name="google-site-verification" content="XxQuw38lagr8-TgtCyhAMP_6ELS9dy35fgrqo9dxw3o" />
    <title>Astrophysics Data System</title>
    <meta name="description" content="A powerful, streamlined new Astrophysics Data System" />
    <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="./styles/favicon/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="./styles/favicon/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="./styles/favicon/favicon-16x16.png" />
    <link rel="manifest" href="./styles/favicon/site.webmanifest" />
    <link rel="mask-icon" href="./styles/favicon/safari-pinned-tab.svg" color="#5bbad5" />
    <meta name="apple-mobile-web-app-title" content="Astrophysics Data System" />
    <meta name="application-name" content="Astrophysics Data System" />
    <meta name="msapplication-TileColor" content="#ffc40d" />
    <meta name="theme-color" content="#ffffff" />
    <!-- /favicon -->
    <link rel="preload" href="./styles/css/styles.css?v=<APP_VERSION>" as="style" />
    <link rel="preload" href="./libs/require.js" as="script" />
    <link rel="preload" href="config/init.js?v=<APP_VERSION>" as="script" />
    <link rel="stylesheet" href="./styles/css/styles.css?v=<APP_VERSION>" />

    <link
      rel="search"
      type="application/opensearchdescription+xml"
      href="https://ui.adsabs.harvard.edu/config/opensearch.xml"
      title="ADS Search"
    />
    <noscript>
      <style>
        #app-container {
          display: none;
        }

        body {
          overflow: hidden;
          position: absolute;
          width: 100%;
          height: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
        }

        #noscriptmsg {
          max-width: 450px;
          padding: 10px;
        }
      </style>
    </noscript>
    <script src="https://www.google.com/recaptcha/api.js?render=6LcpTuUnAAAAAD6YCBdr_2-0b1AH8N6nXkYEG5G5"></script>
    <!-- Google Tag Manager -->
    <script>
      (function(w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
          'gtm.start': new Date().getTime(),
          event: 'gtm.js',
        });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != 'dataLayer' ? '&l=' + l : '';
        j.async = true;
        j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, 'script', 'dataLayer', 'GTM-NT2453N');
    </script>
    <!-- End Google Tag Manager -->
  </head>

  <body>
    <noscript>
      <div id="noscriptmsg">
        <p>
          Sorry, but the fully featured ADS requires JavaScript to be enabled.
        </p>
        <p>
          <a class="btn btn-primary" href="https://ui.adsabs.harvard.edu/core">Click here to switch to Basic HTML</a>
        </p>
      </div>
      <iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-NT2453N"
        height="0"
        width="0"
        style="display:none;visibility:hidden"
      ></iframe>
    </noscript>

    <!--items for announcement of new page, and optional skip to main content link go here (inserted by master.js)-->

    <div id="app-container">
      <!--this is where bbb discovery gets inserted -->
      <div id="body-template-container" role="main">
        <article class="loading-screen" style="display: none">
          <h1 id="loading-screen-title">
            <span class="logo__astrophysics">astrophysics</span>
            <span class="logo__data-system">data system</span>
          </h1>
          <section id="loading-screen-bar">
            <span class="sr-only">loading...</span>
            <div class="progress">
              <div
                class="progress-bar progress-bar-striped active"
                role="progressbar"
                id="loading-screen-progress"
                aria-valuenow="0"
                aria-valuemin="0"
                aria-valuemax="100"
                style="width: 0%"
              >
                <span class="sr-only">0% Complete</span>
                <span id="loading-screen-message"></span>
              </div>
            </div>
          </section>
          <h3 id="basic-html-message">
            Loading ADS |
            <a href="https://ui.adsabs.harvard.edu/core">Click here to switch to Basic HTML</a>
            (for slow connections/low resources)
          </h3>
          <div class="hidden well-sm center-block" id="app-error-container" data-testid="app-error">
            <div class="alert alert-warning small">
              <span id="app-error-message"></span>
            </div>
          </div>
        </article>
      </div>
    </div>
    <div id="darkSwitch" class="darkmode-toggle" title="Turn on dark mode">
      ðŸŒ“
    </div>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "WebSite",
        "name": "ADS",
        "url": "https://ui.absads.harvard.edu/",
        "alternateName": "Astrophysics Data System",
        "potentialAction": {
          "@type": "SearchAction",
          "target": "https://ui.adsabs.harvard.edu/search/q={search_term_string}",
          "query-input": "required name=search_term_string"
        }
      }
    </script>
    <script>
      // Progress Bar
      (function() {
        var loadingContainer = document.querySelector('.loading-screen');
        var progressBar = document.getElementById('loading-screen-progress');
        var message = document.getElementById('loading-screen-message');
        var progressInner = document.querySelector('#loading-screen-progress>span');
        var progressValue = 0;

        // show nothing for the first 3 seconds
        setTimeout(function() {
          loadingContainer.setAttribute('style', '');
        }, 3000);

        /**
         *
         */
        window.__setAppLoadingProgress = function(val, msg) {
          if (typeof val === 'function') {
            const newVal = val(progressValue);
            if (typeof newVal === 'number') {
              return window.__setAppLoadingProgress(newVal, msg);
            }
          }

          if (val < progressValue) return;
          try {
            progressBar.setAttribute('aria-valuenow', val);
            progressBar.style = 'width: ' + val + '%';
            progressInner.innerText = val + '% Complete';
            message.innerHTML = msg ? msg : message.innerHTML;
            progressValue = val;
          } catch (e) {
            // do nothing
          }
        };
        setTimeout(__setAppLoadingProgress, 200, 20);
        setTimeout(__setAppLoadingProgress, 500, 25);
        window.__setAppLoadingProgress(15, 'Downloading Assets');
        window.__PAGE_LOAD_TIMESTAMP = new Date();
      })();
    </script>

    <script>

      /**
       * Function to tag spans with specific descriptions based on URL parameters.
       * @param span
       */
      const tagSpans = (span) => {
        if (!span || !span.data || !span.data['http.url']) {
          return span;
        }
        const url = new URL(span.data['http.url']);
        const params = new URLSearchParams(url.search);

        // Prefer explicit ui_tag param, then tag, for stable grouping
        const uiTag = params.get('ui_tag') || params.get('tag');
        if (uiTag) {
          const tag = uiTag;
          // stable, human-friendly span name
          span.description = tag;
          // attach the tag to span data for additional filtering
          span.data['feature.ui_tag'] = tag;
          return span;
        }

        // check for search (left-side) facets
        if (params.has('facet') && params.get('facet') === 'true') {
          if (params.has('facet.field')) {
            span.description = `${params.get('facet.field')} facet`;
          }

          // check for years graph
          if (params.has('facet.pivot')) {
            const pivot = params.get('facet.pivot');
            if (pivot === 'property,year') {
              span.description = 'years graph';
            }
          }
        }
        if (params.has('stats') && params.get('stats') === 'true') {
          if (params.has('stats.field')) {
            const field = params.get('stats.field');

            // check for citations graph
            if (field === 'citation_count') {
              span.description = 'citations graph';
            }

            // check for reads graph
            if (field === 'read_count') {
              span.description = 'reads graph';
            }
          }
        }

        return span;
      };

      // Simulate a process.env-like environment
      window.process = { env: { NODE_ENV: window.ENV ?? 'production' } };

      // Modern helper for accessing Sentry
      const withSentry = function (callback) {
        if (typeof window.Sentry !== 'undefined') {
          try {
            callback(window.Sentry);
          } catch (e) {
            // Silently handle errors in callback
          }
        }
      };

      // Legacy compatibility helpers for smooth transition
      window.whenSentryReady = function() {
        return new Promise((resolve) => {
          if (typeof window.Sentry !== 'undefined') {
            resolve(window.Sentry);
          } else {
            // If Sentry isn't loaded yet, wait for it
            const checkSentry = () => {
              if (typeof window.Sentry !== 'undefined') {
                resolve(window.Sentry);
              } else {
                setTimeout(checkSentry, 50);
              }
            };
            checkSentry();
          }
        });
      };

      window.getSentry = function(callback, errorCallback = () => {}) {
        if (typeof window.Sentry !== 'undefined') {
          try {
            callback(window.Sentry);
          } catch (e) {
            errorCallback(e);
          }
        } else {
          // If Sentry isn't loaded yet, wait for it
          const checkSentry = () => {
            if (typeof window.Sentry !== 'undefined') {
              try {
                callback(window.Sentry);
              } catch (e) {
                errorCallback(e);
              }
            } else {
              setTimeout(checkSentry, 50);
            }
          };
          checkSentry();
        }
      };

      // Initialize Sentry after the script loads
      function initSentry() {
        if (typeof Sentry !== 'undefined') {
          Sentry.init({
            dsn: 'https://46062cbe0aeb7a3b2bb4c3a9b8cd1ac7@o1060269.ingest.us.sentry.io/4507341192036352',
            tracesSampleRate: window.ENV === 'development' ? 1.0 : 0.75,
            debug: false,
            allowUrls: [
              /https:\/\/.*\.adsabs\.harvard\.edu\/.*/,
              /https:\/\/code\.jquery\.com\/.*/,
              /https:\/\/cdn\.jsdelivr\.net\/.*/,
            ],
            replaysSessionSampleRate: 0,
            replaysOnErrorSampleRate: 0.01,
            environment: window.ENV ?? 'production',
            integrations: [
              Sentry.browserTracingIntegration(),
              Sentry.replayIntegration({
                maskAllText: false,
                blockAllMedia: false,
                unmask: ['[name=q]'],
              }),
            ],
            beforeSendSpan: tagSpans
          });
        }
      }

      
    </script>

    <script
      src="https://browser.sentry-cdn.com/10.21.0/bundle.tracing.replay.min.js"
      integrity="sha384-qMX/qwnFA+J4Pv2Gnngz4M1WmLwT0ajrVIQgtdyRExx0QSoG9rSiLtydtCdYzhzk"
      crossorigin="anonymous"
      onload="initSentry()"
    ></script>

    <!-- start the discovery application -->
    <script src="./libs/require.js"></script>
    <script src="config/init.js?v=<APP_VERSION>"></script>
  </body>
</html>
