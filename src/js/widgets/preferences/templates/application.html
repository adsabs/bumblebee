<div class="panel-heading">Application Settings</div>

<div class="panel-body" id="application-settings-container">
  <div class="row">
    <div class="col-md-12">
      <form id="app-settings-form" role="form" class="form-horizontal">

        <!-- NUM AUTHORS -->
        <div class="form-group">
          <label for="numAuthors">
            Authors Visible Per Result
            <a href="#collapseNumAuthorsDesc" data-toggle="collapse" role="button" aria-expanded="false"
              aria-controls="collapseNumAuthorsDesc">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
          </label>
          <p>
            <div class="collapse" id="collapseNumAuthorsDesc">
              <div class="card card-body text-muted">
                <p>
                  Specifies the number of authors to show under each result before the list is truncated.
                  <br> (
                  <strong>default: {{numAuthorsDefault}}</strong>)
                </p>
              </div>
            </div>
          </p>
          <select class="form-control" id="numAuthors" aria-describedby="collapseNumAuthorsDesc">
            {{#each numAuthorsOptions}}
            <option value="{{this}}" {{#compare this ../numAuthorsSelected}} selected="selected" {{/compare}}>{{this}}
            </option>
            {{/each}}
          </select>
        </div>

        <!-- Always Open Links In New Tab/Same Tab -->
        <div class="form-group">
          <label for="externalLinks">
            Default Action For External Links
            <a href="#collapseExternalLinks" data-toggle="collapse" role="button" aria-expanded="false"
              aria-controls="collapseExternalLinks">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
          </label>
          <p>
            <div class="collapse" id="collapseExternalLinks">
              <div class="card card-body text-muted">
                <p>
                  Select the default action when opening an external link.
                  <br> (
                  <strong>default: {{externalLinksDefault}}</strong>)
                </p>
              </div>
            </div>
          </p>
          <select class="form-control" id="externalLinks" aria-describedby="collapseExternalLinks">
            {{#each externalLinksOptions}}
            <option value="{{this}}" {{#compare this ../externalLinksSelected}} selected="selected" {{/compare}}>
              {{this}}</option>
            {{/each}}
          </select>
        </div>

        <!-- Home Page Default -->
        <div class="form-group">
          <label for="homePage">
            Default Home Page
            <a href="#collapseHomePage" data-toggle="collapse" role="button" aria-expanded="false"
              aria-controls="collapseHomePage">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
          </label>
          <p>
            <div class="collapse" id="collapseHomePage">
              <div class="card card-body text-muted">
                <p>
                  Select the default landing page shown when loading the application or starting a new search.
                  <br> (
                  <strong>default: {{homePageDefault}}</strong>)
                </p>
              </div>
            </div>
          </p>
          <select class="form-control" id="homePage" aria-describedby="collapseHomePage">
            {{#each homePageOptions}}
            <option value="{{this}}" {{#compare this ../homePageSelected}} selected="selected" {{/compare}}>
              {{this}}</option>
            {{/each}}
          </select>
        </div>

        <!-- Default Collection -->
        <div class="form-group">
          <label for="database">
            Default Collection(s)
            <a href="#collapseDatabase" data-toggle="collapse" role="button" aria-expanded="false"
              aria-controls="collapseDatabase">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
          </label>
          <p>
            <div class="collapse" id="collapseDatabase">
              <div class="card card-body text-muted">
                <p>
                  This will apply a default collection facet to each search. You can manually remove or alter it from there.
                  <br> (
                  <strong>default: none</strong>)
                </p>
              </div>
            </div>
          </p>
          <div class="btn-group" data-toggle="buttons">
            {{#each databaseSelected}}
            <label class="database-select btn btn-default {{#if this.value}} active {{/if}}">
              <input type="checkbox" name="database" checked="{{this.value}}" id="database_{{this.name}}"> {{this.name}}
            </label> {{/each}}
          </div>
        </div>

        <!-- Default Export Format -->
        <div class="form-group">
          <label for="exportFormat">
            Default Export Format
            <a href="#collapseExportFormat" data-toggle="collapse" role="button" aria-expanded="false"
              aria-controls="collapseExportFormat">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
          </label>
          <p>
            <div class="collapse" id="collapseExportFormat">
              <div class="card card-body text-muted">
                <p>
                  Select the default export format you would like to use when opening the Export tool.
                  <br> (
                  <strong>default: {{exportFormatDefault}}</strong>)
                </p>
              </div>
            </div>
          </p>
          <select class="form-control" id="exportFormat" aria-describedby="collapseExportFormat">
            {{#each exportFormatOptions}}
            <option value="{{this}}" {{#compare this ../exportFormatSelected}} selected="selected" {{/compare}}>{{this}}
            </option>
            {{/each}}
          </select>
        </div>

        <!-- Custom Formats -->
        <div class="form-group">
          <label for="addCustomFormat">
            Custom Formats
            <a href="#collapseAddCustomFormat" data-toggle="collapse" role="button" aria-expanded="false"
              aria-controls="collapseAddCustomFormat">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
          </label>
          <p>
            <div class="collapse" id="collapseAddCustomFormat">
              <div class="card card-body text-muted">
                <p>
                  Edit your saved custom formats
                </p>
                <p>
                  Check out our <a href="//adsabs.github.io/help/actions/export" rel="noopener" target="_blank">docs</a> for more information.
                </p>
              </div>
            </div>
          </p>
          <p>
            You currently have {{addCustomFormatOptions.length}} format(s) defined.
          </p>
          <div id="addCustomFormat">
            <ul class="list-group col-xs-12">
              {{#each addCustomFormatOptions}}
              <li class="list-group-item clearfix" data-id="{{id}}">
                <div class="col-xs-1">
                  <i class="fa fa-unsorted" aria-hidden="true"></i>
                </div>

                {{#if editing}}
                <div class="col-xs-3">
                  <input type="text" class="form-control custom-format-edit" id="custom-format-name-{{id}}" placeholder="My New Format" value="{{name}}" data-id="{{id}}">
                </div>
                <div class="col-xs-6">
                  <input type="text" class="form-control custom-format-edit" placeholder="%l (%Y), %j, %V, %p.\n" id="custom-format-code-{{id}}" value="{{code}}" data-id="{{id}}">
                </div>
                <span class="col-xs-2 text-right">
                  <button id="addCustomFormatConfirmEdit" role="button" data-id="{{id}}" class="btn-link"
                    title="confirm edit">
                    <i class="fa fa-check text-success" aria-hidden="true"></i>
                  </button>
                  <button id="addCustomFormatCancelEdit" role="button" data-id="{{id}}" class="btn-link"
                    title="cancel edit">
                    <i class="fa fa-times text-danger" aria-hidden="true"></i>
                  </button>
                </span> {{else}}
                <div class="col-xs-3">
                  <p id="custom-format-name-{{id}}">
                    <strong>{{name}}</strong>
                  </p>
                </div>
                <div class="col-xs-6">
                  <p id="custom-format-code-{{id}}">
                    <code>{{code}}</code>
                  </p>
                </div>
                <span class="col-xs-2 text-right">
                  <button id="addCustomFormatEdit" role="button" data-id="{{id}}" class="btn-link"
                    title="edit custom format">
                    <i class="fa fa-pencil text-primary" aria-hidden="true"></i>
                  </button>
                  <button id="addCustomFormatDelete" role="button" data-id="{{id}}" class="btn-link"
                    title="delete custom format">
                    <i class="fa fa-times text-danger" aria-hidden="true"></i>
                  </button>
                </span> {{/if}}
              </li>
              {{else}}
              <div class="well">
                Nothing here... Add a new format below
                <br> (its also possible we didn't properly load your custom formats, please try refreshing this page)
              </div>
              {{/each}}
            </ul>
          </div>
          <p>
            <button class="btn btn-primary" id="addCustomFormatAdd">Add</button> &nbsp;
            <span id="new-format-msg" class="text-muted" style="display: none">
              New format added!
            </span>
          </p>
        </div>

        <!-- Default Show/Hide Sidebars -->
        <div class="form-group">
          <label for="hideSideBars">
            Results List Side Bars
            <a href="#collapseHideSideBars" data-toggle="collapse" role="button" aria-expanded="false"
              aria-controls="collapseHideSideBars">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
          </label>
          <p>
            <div class="collapse" id="collapseHideSideBars">
              <div class="card card-body text-muted">
                <p>
                  Select the default state of the results list sidebars (hide/show)
                  <br> (
                  <strong>default: {{hideSideBarsDefault}}</strong>)
                </p>
              </div>
            </div>
          </p>
          <select class="form-control" id="hideSideBars" aria-describedby="collapseHideSideBars">
            {{#each hideSideBarsOptions}}
            <option value="{{this}}" {{#compare this ../hideSideBarsSelected}} selected="selected" {{/compare}}>{{this}}
            </option>
            {{/each}}
          </select>
        </div>

        <!-- Set BibTeX key format  -->
        <div class="form-group">
          <label for="bibtexKeyFormat">
            BibTeX Default Export Key Format
            <a href="#collapsebibtexKeyFormat" data-toggle="collapse" role="button" aria-expanded="false"
              aria-controls="collapsebibtexKeyFormat">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
          </label>
          <p>
            <div class="collapse" id="collapsebibtexKeyFormat">
              <div class="card card-body text-muted">
                <p>
                  Select the default key format when exporting in BibTeX (<a href="http://adsabs.github.io/help/actions/export" rel="noopener" target="_blank">Learn More <i
                      class="fa fa-external-link" aria-hidden="true"></i></a>)
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Code</th>
                        <th>Description</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><code>%R</code></td>
                        <td>Bibcode</td>
                      </tr>
                      <tr>
                        <td><code>%nH</code></td>
                        <td>Author, where <code>n</code> can be any number</td>
                      </tr>
                      <tr>
                        <td><code>%q</code></td>
                        <td>Publication</td>
                      </tr>
                      <tr>
                        <td><code>%Y</code></td>
                        <td>Year</td>
                      </tr>
                    </tbody>
                  </table>
                  <p>* Any other text will be passed as raw strings</p>
                  (<strong>default: None</strong>)
                </p>
              </div>
            </div>
          </p>
          <input type="text" id="bibtexKeyFormat" value="{{bibtexKeyFormatSelected}}" data-no-convert="true" aria-describedby="collapsebibtexKeyFormat" placeholder="%1H:%Y:%q" class="form-control" title="bibtex key format" maxlength="30">
        </div>

        <div class="row">
          <div class="col-sm-5">
            <!-- Set BibTeX key max authors  -->
            <div class="form-group">
              <label for="bibtexMaxAuthors">
                BibTeX Default Export Max Authors
                <a href="#collapsebibtexMaxAuthors" data-toggle="collapse" role="button" aria-expanded="false"
                  aria-controls="collapsebibtexMaxAuthors">
                  <i class="fa fa-question-circle" aria-hidden="true"></i>
                </a>
              </label>
              <p>
                <div class="collapse" id="collapsebibtexMaxAuthors">
                  <div class="card card-body text-muted">
                    <p>
                      Select the default max number of authors shown when exporting in BibTeX
                      <br> (
                      <strong>default: {{bibtexMaxAuthorsDefault}}</strong>)
                    </p>
                  </div>
                </div>
              </p>
              <select class="form-control" id="bibtexMaxAuthors" aria-describedby="collapsebibtexMaxAuthors">
                {{#each bibtexMaxAuthorsOptions}}
                <option value="{{this}}" {{#compare this ../bibtexMaxAuthorsSelected}} selected="selected" {{/compare}}>
                  {{this}}</option>
                {{/each}}
              </select>
            </div>
          </div>
          <div class="col-sm-5 col-sm-offset-2">
            <!-- Set BibTeX author cutoff  -->
            <div class="form-group">
              <label for="bibtexAuthorCutoff">
                BibTeX Default Author Cutoff
                <a href="#collapsebibtexAuthorCutoff" data-toggle="collapse" role="button" aria-expanded="false"
                  aria-controls="collapsebibtexAuthorCutoff">
                  <i class="fa fa-question-circle" aria-hidden="true"></i>
                </a>
              </label>
              <p>
                <div class="collapse" id="collapsebibtexAuthorCutoff">
                  <div class="card card-body text-muted">
                    <p>
                        <p>
                          If the number of authors in the list is larger than the cutoff,
                          the list will be truncated to the max number allowed, otherwise all will be shown.
                        </p>
                      <br> (
                      <strong>default: {{bibtexAuthorCutoffDefault}}</strong>)
                    </p>
                  </div>
                </div>
              </p>
              <select class="form-control" id="bibtexAuthorCutoff" aria-describedby="collapsebibtexAuthorCutoff">
                {{#each bibtexAuthorCutoffOptions}}
                <option value="{{this}}" {{#compare this ../bibtexAuthorCutoffSelected}} selected="selected" {{/compare}}>
                  {{this}}</option>
                {{/each}}
              </select>
            </div>
          </div>
        </div>

        <!-- Set BibTeX ABS key format  -->
        <div class="form-group">
          <label for="bibtexABSKeyFormat">
            BibTeX ABS Default Export Key Format
            <a href="#collapsebibtexABSKeyFormat" data-toggle="collapse" role="button" aria-expanded="false"
              aria-controls="collapsebibtexABSKeyFormat">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
          </label>
          <p>
            <div class="collapse" id="collapsebibtexABSKeyFormat">
              <div class="card card-body text-muted">
                <p>
                  Select the default key format when exporting in BibTeX ABS (<a href="http://adsabs.github.io/help/actions/export" rel="noopener" target="_blank">Learn More <i
                      class="fa fa-external-link" aria-hidden="true"></i></a>)
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Code</th>
                        <th>Description</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><code>%R</code></td>
                        <td>Bibcode</td>
                      </tr>
                      <tr>
                        <td><code>%nH</code></td>
                        <td>Author, where <code>n</code> can be any number</td>
                      </tr>
                      <tr>
                        <td><code>%q</code></td>
                        <td>Publication</td>
                      </tr>
                      <tr>
                        <td><code>%Y</code></td>
                        <td>Year</td>
                      </tr>
                    </tbody>
                  </table>
                  <p>* Any other text will be passed as raw strings</p>
                  (<strong>default: None</strong>)
                </p>
              </div>
            </div>
          </p>
          <input type="text" id="bibtexABSKeyFormat" value="{{bibtexABSKeyFormatSelected}}" data-no-convert="true" aria-describedby="collapsebibtexABSKeyFormat" placeholder="%1H:%Y:%q" class="form-control" title="bibtex ABS key format" maxlength="30">
        </div>

        <div class="row">
          <div class="col-sm-5">
            <!-- Set BibTeX ABS key max authors -->
            <div class="form-group">
              <label for="bibtexABSMaxAuthors">
                BibTeX ABS Default Export Max Authors
                <a href="#collapsebibtexABSMaxAuthors" data-toggle="collapse" role="button" aria-expanded="false"
                  aria-controls="collapsebibtexABSMaxAuthors">
                  <i class="fa fa-question-circle" aria-hidden="true"></i>
                </a>
              </label>
                <p>
                  <div class="collapse" id="collapsebibtexABSMaxAuthors">
                    <div class="card card-body text-muted">
                      <p>
                        Select the default max number of authors shown when exporting in BibTeX ABS
                        <br> (
                        <strong>default: {{bibtexABSMaxAuthorsDefault}}</strong>)
                      </p>
                    </div>
                  </div>
                </p>
                <select class="form-control" id="bibtexABSMaxAuthors" aria-describedby="collapsebibtexABSMaxAuthors">
                {{#each bibtexABSMaxAuthorsOptions}}
                <option value="{{this}}" {{#compare this ../bibtexABSMaxAuthorsSelected}} selected="selected" {{/compare}}>
                  {{this}}</option>
                {{/each}}
              </select>
            </div>
          </div>
          <div class="col-sm-5 col-sm-offset-2">
            <!-- Set BibTeX ABS author cutoff  -->
            <div class="form-group">
              <label for="bibtexABSAuthorCutoff">
                BibTeX ABS Default Author Cutoff
                <a href="#collapsebibtexABSAuthorCutoff" data-toggle="collapse" role="button" aria-expanded="false"
                  aria-controls="collapsebibtexABSAuthorCutoff">
                  <i class="fa fa-question-circle" aria-hidden="true"></i>
                </a>
              </label>
              <p>
                <div class="collapse" id="collapsebibtexABSAuthorCutoff">
                  <div class="card card-body text-muted">
                    <p>
                        <p>
                          If the number of authors in the list is larger than the cutoff,
                          the list will be truncated to the max number allowed, otherwise all will be shown.
                        </p>
                      <br> (
                      <strong>default: {{bibtexABSAuthorCutoffDefault}}</strong>)
                    </p>
                  </div>
                </div>
              </p>
              <select class="form-control" id="bibtexABSAuthorCutoff" aria-describedby="collapsebibtexABSAuthorCutoff">
                {{#each bibtexABSAuthorCutoffOptions}}
                <option value="{{this}}" {{#compare this ../bibtexABSAuthorCutoffSelected}} selected="selected" {{/compare}}>
                  {{this}}</option>
                {{/each}}
              </select>
            </div>
          </div>
        </div>
      </form>

      <div class="col-md-6 col-md-offset-3 text-center" id="app-settings-msg">
        {{#if loading}}
        <i class="text-muted fa fa-refresh fa-spin fa-3x" aria-hidden="true"></i> {{/if}} {{#if updateSucceeded}}
        <div class="alert alert-success fade in h4" role="alert">
          <i class="fa fa-check fa-2x" aria-hidden="true"></i> Settings updated successfully
        </div>
        {{/if}} {{#if updateFailed}}
        <div class="alert alert-danger fade in h4" role="alert">
          <i class="fa fa-times fa-3x" aria-hidden="true"></i> Settings not updated, please try again.
        </div>
        {{/if}}
      </div>
    </div>
  </div>
</div>
